<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TITAN BOT 2026 - Control Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="/static/style.css?v=3" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .titan-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .composite-gauge {
            text-align: center;
            padding: 30px;
            background: rgba(168, 85, 247, 0.1);
            border: 1px solid rgba(168, 85, 247, 0.3);
            border-radius: 20px;
        }

        .score-value {
            font-size: 4em;
            font-weight: 700;
            color: #a855f7;
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.5);
        }

        .component-list {
            list-style: none;
            padding: 0;
        }

        .component-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .component-bar {
            height: 6px;
            background: #334155;
            border-radius: 3px;
            width: 100px;
            overflow: hidden;
        }

        .component-fill {
            height: 100%;
            background: #a855f7;
        }

        .titan-header {
            background: linear-gradient(90deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2em;
            font-weight: 800;
            margin-bottom: 20px;
        }
    </style>
</head>

<body class="dark-theme">
    <div class="app-container">
        <header class="top-bar glass">
            <div class="logo">
                <i class="fa-solid fa-bolt" style="color: #a855f7;"></i> TITANBOT 2026
            </div>
            <div style="display: flex; align-items: center; gap: 15px;">
                <a href="/" class="btn"
                    style="background: rgba(255, 255, 255, 0.1); color: #fff; border: 1px solid rgba(255,255,255,0.2); padding: 5px 15px; border-radius: 6px; text-decoration: none;">
                    <i class="fa-solid fa-house"></i> Главная
                </a>
            </div>
        </header>

        <main class="main-content">
            <div class="titan-header">TITAN ULTIMATE FINAL EDITION</div>

            <div class="titan-grid">
                <div class="composite-gauge glass">
                    <h3>COMPOSITE SCORE</h3>
                    <div class="score-value" id="titanScore">+0.0</div>
                    <div id="titanDirection" style="font-weight: bold; margin-bottom: 10px;">NEUTRAL</div>
                    <div id="titanBar"
                        style="height: 10px; background: #334155; border-radius: 5px; width: 80%; margin: 0 auto; overflow: hidden;">
                        <div id="titanFill"
                            style="height: 100%; width: 50%; background: #a855f7; transition: all 0.5s ease;"></div>
                    </div>
                    <p id="titanRecommendation" style="margin-top: 20px; color: #cbd5e1; font-style: italic;"></p>
                </div>

                <div class="card glass">
                    <h3><i class="fa-solid fa-microchip"></i> Анализ компонентов</h3>
                    <ul class="component-list" id="titanComponents">
                        <!-- Будет заполнено JS -->
                    </ul>
                </div>
            </div>

            <div style="margin-top: 20px;" class="titan-grid">
                <div class="card glass">
                    <h3><i class="fa-solid fa-mountain-sun"></i> Рыночный Контекст</h3>
                    <div id="titanContext" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div class="stat-card">
                            <span class="label">Fear & Greed</span>
                            <span class="value" id="valFearGreed">--</span>
                        </div>
                        <div class="stat-card">
                            <span class="label">Whale Activity</span>
                            <span class="value" id="valWhales">--</span>
                        </div>
                        <div class="stat-card">
                            <span class="label">Market Regime</span>
                            <span class="value" id="valRegime">--</span>
                        </div>
                        <div class="stat-card">
                            <span class="label">Correlation</span>
                            <span class="value" id="valCorrelation">--</span>
                        </div>
                    </div>
                </div>

                <div class="card glass">
                    <h3><i class="fa-solid fa-triangle-exclamation"></i> Конфликты Моделей</h3>
                    <div id="titanConflicts" style="color: #fca5a5; font-size: 0.9em;">
                        Конфликтов не обнаружено.
                    </div>
                </div>
            </div>

            <!-- Terminal UI for Titan -->
            <div class="card glass" style="margin-top: 20px; padding: 0;">
                <div style="padding: 12px; background: rgba(255,255,255,0.05);">
                    <i class="fa-solid fa-terminal"></i> Titan Live Console
                </div>
                <div id="titanLog"
                    style="height: 200px; overflow-y: auto; padding: 15px; font-family: monospace; font-size: 0.85em; color: #a855f7;">
                    [SYSTEM] Titan Bot Standby...
                </div>
            </div>
        </main>
    </div>

    <script>
        async function updateTitanData() {
            try {
                const response = await fetch('/api/status');
                const data = await response.json();

                // Эмуляция данных для Titan (пока они не передаются в API полностью)
                // В реальности мы расширим API, но для демо покажем текущий статус
                document.getElementById('titanScore').innerText = data.regime === 'RISK_ON' ? '+62.5' : (data.regime === 'RISK_OFF' ? '-45.0' : '+5.2');
                document.getElementById('titanDirection').innerText = data.regime === 'RISK_ON' ? 'STRONG LONG' : (data.regime === 'RISK_OFF' ? 'STRONG SHORT' : 'NEUTRAL');

                const fill = document.getElementById('titanFill');
                if (data.regime === 'RISK_ON') fill.style.width = '85%';
                else if (data.regime === 'RISK_OFF') fill.style.width = '15%';
                else fill.style.width = '50%';

                document.getElementById('titanRecommendation').innerText = data.recommendation;

                document.getElementById('valFearGreed').innerText = data.sentiment_regime || 'Neutral';
                document.getElementById('valRegime').innerText = data.regime;
                document.getElementById('valWhales').innerText = 'Accumulating';
                document.getElementById('valCorrelation').innerText = 'Stable';

                // Компоненты (демо)
                const components = [
                    { name: 'MTF Trend', val: 0.8 },
                    { name: 'SMC Setup', val: 0.75 },
                    { name: 'Order Flow', val: 0.6 },
                    { name: 'Volume Profile', val: 0.9 },
                    { name: 'Open Interest', val: -0.2 }
                ];

                const list = document.getElementById('titanComponents');
                list.innerHTML = components.map(c => `
                    <li class="component-item">
                        <span>${c.name}</span>
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="color: ${c.val > 0 ? '#22c55e' : '#ef4444'}">${c.val > 0 ? '+' : ''}${c.val}</span>
                            <div class="component-bar">
                                <div class="component-fill" style="width: ${Math.abs(c.val) * 100}%; background: ${c.val > 0 ? '#22c55e' : '#ef4444'}"></div>
                            </div>
                        </div>
                    </li>
                `).join('');

            } catch (e) {
                console.error("Failed to fetch titan status", e);
            }
        }

        setInterval(updateTitanData, 3000);
        updateTitanData();
    </script>
</body>

</html>